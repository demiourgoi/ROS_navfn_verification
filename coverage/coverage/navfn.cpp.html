<!DOCTYPE html>
<html><head><meta name="viewport" content="width=device-width,initial-scale=1"/><meta charset="UTF-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><title>Coverage report - NavFn</title></head><body><h2>Coverage Report</h2><h4>Created: 2022-07-15 12:00</h4><div class="centered"><table><div class="source-name-title"><pre>nav2_navfn_planner::NavFn::setupNavFn(bool)</pre></div><tr><td><pre>Line</pre></td><td><pre>Count</pre></td><td><pre>Source (<a href="#L346">jump to first uncovered line</a>)</pre></td><td><pre>Explanation</pre></td></tr><tr><td class="line-number"><a name="L342" href="#L342"><pre>342</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>{</pre></td><td/></tr><tr><td class="line-number"><a name="L343" href="#L343"><pre>343</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // reset values in propagation arrays</pre></td><td/></tr><tr><td class="line-number"><a name="L344" href="#L344"><pre>344</pre></a></td><td class="covered-line"><pre>49.4M</pre></td><td class="code"><pre>  for (int i = 0; i &lt; ns; <div class="tooltip">i++<span class="tooltip-content">49.3M</span></div>) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L344" href="#L344"><span>344:19</span></a></span>): [<span class="None">True</span>: <span class="covered-line">49.3M</span>, <span class="None">False</span>: <span class="covered-line">121k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L345" href="#L345"><pre>345</pre></a></td><td class="covered-line"><pre>49.3M</pre></td><td class="code"><pre>    potarr[i] = POT_HIGH;</pre></td><td/></tr><tr><td class="line-number"><a name="L346" href="#L346"><pre>346</pre></a></td><td class="covered-line"><pre>49.3M</pre></td><td class="code"><pre>    if (!keepit) <span class="red">{</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L346" href="#L346"><span>346:9</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">49.3M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L347" href="#L347"><pre>347</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      costarr[i] = </span><span class="red">COST_NEUTRAL</span><span class="red">;</span></pre></td><td class="explanation"><code>keepit</code> should always be true since otherwise the map will be cleared</td></tr><tr><td class="line-number"><a name="L348" href="#L348"><pre>348</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    }</span></pre></td><td/></tr><tr><td class="line-number"><a name="L349" href="#L349"><pre>349</pre></a></td><td class="covered-line"><pre>49.3M</pre></td><td class="code"><pre>    gradx[i] = grady[i] = 0.0;</pre></td><td/></tr><tr><td class="line-number"><a name="L350" href="#L350"><pre>350</pre></a></td><td class="covered-line"><pre>49.3M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L351" href="#L351"><pre>351</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L352" href="#L352"><pre>352</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // outer bounds of cost array</pre></td><td/></tr><tr><td class="line-number"><a name="L353" href="#L353"><pre>353</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  COSTTYPE * pc;</pre></td><td/></tr><tr><td class="line-number"><a name="L354" href="#L354"><pre>354</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  pc = costarr;</pre></td><td/></tr><tr><td class="line-number"><a name="L355" href="#L355"><pre>355</pre></a></td><td class="covered-line"><pre>1.87M</pre></td><td class="code"><pre>  for (int i = 0; i &lt; nx; <div class="tooltip">i++<span class="tooltip-content">1.75M</span></div>) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L355" href="#L355"><span>355:19</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.75M</span>, <span class="None">False</span>: <span class="covered-line">121k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L356" href="#L356"><pre>356</pre></a></td><td class="covered-line"><pre>1.75M</pre></td><td class="code"><pre>    *pc++ = COST_OBS;</pre></td><td/></tr><tr><td class="line-number"><a name="L357" href="#L357"><pre>357</pre></a></td><td class="covered-line"><pre>1.75M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L358" href="#L358"><pre>358</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  pc = costarr + (ny - 1) * nx;</pre></td><td/></tr><tr><td class="line-number"><a name="L359" href="#L359"><pre>359</pre></a></td><td class="covered-line"><pre>1.87M</pre></td><td class="code"><pre>  for (int i = 0; i &lt; nx; <div class="tooltip">i++<span class="tooltip-content">1.75M</span></div>) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L359" href="#L359"><span>359:19</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.75M</span>, <span class="None">False</span>: <span class="covered-line">121k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L360" href="#L360"><pre>360</pre></a></td><td class="covered-line"><pre>1.75M</pre></td><td class="code"><pre>    *pc++ = COST_OBS;</pre></td><td/></tr><tr><td class="line-number"><a name="L361" href="#L361"><pre>361</pre></a></td><td class="covered-line"><pre>1.75M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L362" href="#L362"><pre>362</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  pc = costarr;</pre></td><td/></tr><tr><td class="line-number"><a name="L363" href="#L363"><pre>363</pre></a></td><td class="covered-line"><pre>1.95M</pre></td><td class="code"><pre>  for (int i = 0; i &lt; ny; <div class="tooltip">i++, pc += nx<span class="tooltip-content">1.83M</span></div>) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L363" href="#L363"><span>363:19</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.83M</span>, <span class="None">False</span>: <span class="covered-line">121k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L364" href="#L364"><pre>364</pre></a></td><td class="covered-line"><pre>1.83M</pre></td><td class="code"><pre>    *pc = COST_OBS;</pre></td><td/></tr><tr><td class="line-number"><a name="L365" href="#L365"><pre>365</pre></a></td><td class="covered-line"><pre>1.83M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L366" href="#L366"><pre>366</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  pc = costarr + nx - 1;</pre></td><td/></tr><tr><td class="line-number"><a name="L367" href="#L367"><pre>367</pre></a></td><td class="covered-line"><pre>1.95M</pre></td><td class="code"><pre>  for (int i = 0; i &lt; ny; <div class="tooltip">i++, pc += nx<span class="tooltip-content">1.83M</span></div>) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L367" href="#L367"><span>367:19</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.83M</span>, <span class="None">False</span>: <span class="covered-line">121k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L368" href="#L368"><pre>368</pre></a></td><td class="covered-line"><pre>1.83M</pre></td><td class="code"><pre>    *pc = COST_OBS;</pre></td><td/></tr><tr><td class="line-number"><a name="L369" href="#L369"><pre>369</pre></a></td><td class="covered-line"><pre>1.83M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L370" href="#L370"><pre>370</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L371" href="#L371"><pre>371</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // priority buffers</pre></td><td/></tr><tr><td class="line-number"><a name="L372" href="#L372"><pre>372</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  curT = COST_OBS;</pre></td><td/></tr><tr><td class="line-number"><a name="L373" href="#L373"><pre>373</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  curP = pb1;</pre></td><td/></tr><tr><td class="line-number"><a name="L374" href="#L374"><pre>374</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  curPe = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L375" href="#L375"><pre>375</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  nextP = pb2;</pre></td><td/></tr><tr><td class="line-number"><a name="L376" href="#L376"><pre>376</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  nextPe = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L377" href="#L377"><pre>377</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  overP = pb3;</pre></td><td/></tr><tr><td class="line-number"><a name="L378" href="#L378"><pre>378</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  overPe = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L379" href="#L379"><pre>379</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  memset(pending, 0, ns * sizeof(bool));</pre></td><td/></tr><tr><td class="line-number"><a name="L380" href="#L380"><pre>380</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L381" href="#L381"><pre>381</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // set goal</pre></td><td/></tr><tr><td class="line-number"><a name="L382" href="#L382"><pre>382</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  int k = goal[0] + goal[1] * nx;</pre></td><td/></tr><tr><td class="line-number"><a name="L383" href="#L383"><pre>383</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  initCost(k, 0);</pre></td><td/></tr><tr><td class="line-number"><a name="L384" href="#L384"><pre>384</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L385" href="#L385"><pre>385</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // find # of obstacle cells</pre></td><td/></tr><tr><td class="line-number"><a name="L386" href="#L386"><pre>386</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  pc = costarr;</pre></td><td/></tr><tr><td class="line-number"><a name="L387" href="#L387"><pre>387</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  int ntot = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L388" href="#L388"><pre>388</pre></a></td><td class="covered-line"><pre>49.4M</pre></td><td class="code"><pre>  for (int i = 0; i &lt; ns; <div class="tooltip">i++, pc++<span class="tooltip-content">49.3M</span></div>) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L388" href="#L388"><span>388:19</span></a></span>): [<span class="None">True</span>: <span class="covered-line">49.3M</span>, <span class="None">False</span>: <span class="covered-line">121k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L389" href="#L389"><pre>389</pre></a></td><td class="covered-line"><pre>49.3M</pre></td><td class="code"><pre>    if (*pc &gt;= COST_OBS) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L389" href="#L389"><span>389:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">16.8M</span>, <span class="None">False</span>: <span class="covered-line">32.4M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L390" href="#L390"><pre>390</pre></a></td><td class="covered-line"><pre>16.8M</pre></td><td class="code"><pre>      ntot++;  // number of cells that are obstacles</pre></td><td/></tr><tr><td class="line-number"><a name="L391" href="#L391"><pre>391</pre></a></td><td class="covered-line"><pre>16.8M</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L392" href="#L392"><pre>392</pre></a></td><td class="covered-line"><pre>49.3M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L393" href="#L393"><pre>393</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  nobs = ntot;</pre></td><td/></tr><tr><td class="line-number"><a name="L394" href="#L394"><pre>394</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>}</pre></td><td/></tr></table></div><div class="centered"><table><div class="source-name-title"><pre>nav2_navfn_planner::NavFn::initCost(int, float)</pre></div><tr><td><pre>Line</pre></td><td><pre>Count</pre></td><td><pre>Source</pre></td><td><pre>Explanation</pre></td></tr><tr><td class="line-number"><a name="L401" href="#L401"><pre>401</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>{</pre></td><td/></tr><tr><td class="line-number"><a name="L402" href="#L402"><pre>402</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  potarr[k] = v;</pre></td><td/></tr><tr><td class="line-number"><a name="L403" href="#L403"><pre>403</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  push_cur(k + 1);</pre></td><td/></tr><tr><td class="line-number"><a name="L404" href="#L404"><pre>404</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  push_cur(k - 1);</pre></td><td/></tr><tr><td class="line-number"><a name="L405" href="#L405"><pre>405</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  push_cur(k - nx);</pre></td><td/></tr><tr><td class="line-number"><a name="L406" href="#L406"><pre>406</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  push_cur(k + nx);</pre></td><td/></tr><tr><td class="line-number"><a name="L407" href="#L407"><pre>407</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>}</pre></td><td/></tr></table></div><div class="centered"><table><div class="source-name-title"><pre>nav2_navfn_planner::NavFn::propNavFnAstar(int)</pre></div><tr><td><pre>Line</pre></td><td><pre>Count</pre></td><td><pre>Source</pre></td><td><pre>Explanation</pre></td></tr><tr><td class="line-number"><a name="L658" href="#L658"><pre>658</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>{</pre></td><td/></tr><tr><td class="line-number"><a name="L659" href="#L659"><pre>659</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  int nwv = 0;  // max priority block size</pre></td><td/></tr><tr><td class="line-number"><a name="L660" href="#L660"><pre>660</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  int nc = 0;  // number of cells put into priority blocks</pre></td><td/></tr><tr><td class="line-number"><a name="L661" href="#L661"><pre>661</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  int cycle = 0;  // which cycle we're on</pre></td><td/></tr><tr><td class="line-number"><a name="L662" href="#L662"><pre>662</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L663" href="#L663"><pre>663</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // set initial threshold, based on distance</pre></td><td/></tr><tr><td class="line-number"><a name="L664" href="#L664"><pre>664</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  float dist = hypot(goal[0] - start[0], goal[1] - start[1]) * static_cast&lt;float&gt;(COST_NEUTRAL);</pre></td><td/></tr><tr><td class="line-number"><a name="L665" href="#L665"><pre>665</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  curT = dist + curT;</pre></td><td/></tr><tr><td class="line-number"><a name="L666" href="#L666"><pre>666</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L667" href="#L667"><pre>667</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // set up start cell</pre></td><td/></tr><tr><td class="line-number"><a name="L668" href="#L668"><pre>668</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  int startCell = start[1] * nx + start[0];</pre></td><td/></tr><tr><td class="line-number"><a name="L669" href="#L669"><pre>669</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L670" href="#L670"><pre>670</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // do main cycle</pre></td><td/></tr><tr><td class="line-number"><a name="L671" href="#L671"><pre>671</pre></a></td><td class="covered-line"><pre>1.25M</pre></td><td class="code"><pre>  for (; cycle &lt; cycles; <div class="tooltip">cycle++<span class="tooltip-content">1.13M</span></div>) {  // go for this many cycles, unless interrupted</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L671" href="#L671"><span>671:10</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.24M</span>, <span class="None">False</span>: <span class="covered-line">13.7k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L672" href="#L672"><pre>672</pre></a></td><td class="covered-line"><pre>1.24M</pre></td><td class="code"><pre>    if (curPe == 0 &amp;&amp; <div class="tooltip">nextPe == 0<span class="tooltip-content">33.6k</span></div>) {  // priority blocks empty</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L672" href="#L672"><span>672:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">33.6k</span>, <span class="None">False</span>: <span class="covered-line">1.20M</span>]
  Branch (<span class="line-number"><a name="L672" href="#L672"><span>672:23</span></a></span>): [<span class="None">True</span>: <span class="covered-line">33.6k</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td class="explanation"><code>nextPe</code> is always zero here, since it is set in line <a href="#L702">702</a> and not changed since then</td></tr><tr><td class="line-number"><a name="L673" href="#L673"><pre>673</pre></a></td><td class="covered-line"><pre>33.6k</pre></td><td class="code"><pre>      break;</pre></td><td/></tr><tr><td class="line-number"><a name="L674" href="#L674"><pre>674</pre></a></td><td class="covered-line"><pre>33.6k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L675" href="#L675"><pre>675</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L676" href="#L676"><pre>676</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // stats</pre></td><td/></tr><tr><td class="line-number"><a name="L677" href="#L677"><pre>677</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    nc += curPe;</pre></td><td/></tr><tr><td class="line-number"><a name="L678" href="#L678"><pre>678</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    if (curPe &gt; nwv) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L678" href="#L678"><span>678:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">261k</span>, <span class="None">False</span>: <span class="covered-line">946k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L679" href="#L679"><pre>679</pre></a></td><td class="covered-line"><pre>261k</pre></td><td class="code"><pre>      nwv = curPe;</pre></td><td/></tr><tr><td class="line-number"><a name="L680" href="#L680"><pre>680</pre></a></td><td class="covered-line"><pre>261k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L681" href="#L681"><pre>681</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L682" href="#L682"><pre>682</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // reset pending flags on current priority buffer</pre></td><td/></tr><tr><td class="line-number"><a name="L683" href="#L683"><pre>683</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    int * pb = curP;</pre></td><td/></tr><tr><td class="line-number"><a name="L684" href="#L684"><pre>684</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    int i = curPe;</pre></td><td/></tr><tr><td class="line-number"><a name="L685" href="#L685"><pre>685</pre></a></td><td class="covered-line"><pre>5.77M</pre></td><td class="code"><pre>    while (i-- &gt; 0) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L685" href="#L685"><span>685:12</span></a></span>): [<span class="None">True</span>: <span class="covered-line">4.56M</span>, <span class="None">False</span>: <span class="covered-line">1.20M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L686" href="#L686"><pre>686</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>      pending[*(pb++)] = false;</pre></td><td/></tr><tr><td class="line-number"><a name="L687" href="#L687"><pre>687</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L688" href="#L688"><pre>688</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L689" href="#L689"><pre>689</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // process current priority buffer</pre></td><td/></tr><tr><td class="line-number"><a name="L690" href="#L690"><pre>690</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    pb = curP;</pre></td><td/></tr><tr><td class="line-number"><a name="L691" href="#L691"><pre>691</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    i = curPe;</pre></td><td/></tr><tr><td class="line-number"><a name="L692" href="#L692"><pre>692</pre></a></td><td class="covered-line"><pre>5.77M</pre></td><td class="code"><pre>    while (i-- &gt; 0) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L692" href="#L692"><span>692:12</span></a></span>): [<span class="None">True</span>: <span class="covered-line">4.56M</span>, <span class="None">False</span>: <span class="covered-line">1.20M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L693" href="#L693"><pre>693</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>      updateCellAstar(*pb++);</pre></td><td/></tr><tr><td class="line-number"><a name="L694" href="#L694"><pre>694</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L695" href="#L695"><pre>695</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L696" href="#L696"><pre>696</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // if (displayInt &gt; 0 &amp;&amp; (cycle % displayInt) == 0) {</pre></td><td/></tr><tr><td class="line-number"><a name="L697" href="#L697"><pre>697</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    //   displayFn(this);</pre></td><td/></tr><tr><td class="line-number"><a name="L698" href="#L698"><pre>698</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // }</pre></td><td/></tr><tr><td class="line-number"><a name="L699" href="#L699"><pre>699</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L700" href="#L700"><pre>700</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // swap priority blocks curP &lt;=&gt; nextP</pre></td><td/></tr><tr><td class="line-number"><a name="L701" href="#L701"><pre>701</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    curPe = nextPe;</pre></td><td/></tr><tr><td class="line-number"><a name="L702" href="#L702"><pre>702</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    nextPe = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L703" href="#L703"><pre>703</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    pb = curP;  // swap buffers</pre></td><td/></tr><tr><td class="line-number"><a name="L704" href="#L704"><pre>704</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    curP = nextP;</pre></td><td/></tr><tr><td class="line-number"><a name="L705" href="#L705"><pre>705</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    nextP = pb;</pre></td><td/></tr><tr><td class="line-number"><a name="L706" href="#L706"><pre>706</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L707" href="#L707"><pre>707</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // see if we're done with this priority level</pre></td><td/></tr><tr><td class="line-number"><a name="L708" href="#L708"><pre>708</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    if (curPe == 0) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L708" href="#L708"><span>708:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">475k</span>, <span class="None">False</span>: <span class="covered-line">732k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L709" href="#L709"><pre>709</pre></a></td><td class="covered-line"><pre>475k</pre></td><td class="code"><pre>      curT += priInc;  // increment priority threshold</pre></td><td/></tr><tr><td class="line-number"><a name="L710" href="#L710"><pre>710</pre></a></td><td class="covered-line"><pre>475k</pre></td><td class="code"><pre>      curPe = overPe;  // set current to overflow block</pre></td><td/></tr><tr><td class="line-number"><a name="L711" href="#L711"><pre>711</pre></a></td><td class="covered-line"><pre>475k</pre></td><td class="code"><pre>      overPe = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L712" href="#L712"><pre>712</pre></a></td><td class="covered-line"><pre>475k</pre></td><td class="code"><pre>      pb = curP;  // swap buffers</pre></td><td/></tr><tr><td class="line-number"><a name="L713" href="#L713"><pre>713</pre></a></td><td class="covered-line"><pre>475k</pre></td><td class="code"><pre>      curP = overP;</pre></td><td/></tr><tr><td class="line-number"><a name="L714" href="#L714"><pre>714</pre></a></td><td class="covered-line"><pre>475k</pre></td><td class="code"><pre>      overP = pb;</pre></td><td/></tr><tr><td class="line-number"><a name="L715" href="#L715"><pre>715</pre></a></td><td class="covered-line"><pre>475k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L716" href="#L716"><pre>716</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L717" href="#L717"><pre>717</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // check if we've hit the Start cell</pre></td><td/></tr><tr><td class="line-number"><a name="L718" href="#L718"><pre>718</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>    if (potarr[startCell] &lt; POT_HIGH) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L718" href="#L718"><span>718:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">73.9k</span>, <span class="None">False</span>: <span class="covered-line">1.13M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L719" href="#L719"><pre>719</pre></a></td><td class="covered-line"><pre>73.9k</pre></td><td class="code"><pre>      break;</pre></td><td/></tr><tr><td class="line-number"><a name="L720" href="#L720"><pre>720</pre></a></td><td class="covered-line"><pre>73.9k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L721" href="#L721"><pre>721</pre></a></td><td class="covered-line"><pre>1.20M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L722" href="#L722"><pre>722</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L723" href="#L723"><pre>723</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  last_path_cost_ = potarr[startCell];</pre></td><td/></tr><tr><td class="line-number"><a name="L724" href="#L724"><pre>724</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L725" href="#L725"><pre>725</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  RCLCPP_DEBUG(</pre></td><td/></tr><tr><td class="line-number"><a name="L726" href="#L726"><pre>726</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>    rclcpp::get_logger("rclcpp"),</pre></td><td/></tr><tr><td class="line-number"><a name="L727" href="#L727"><pre>727</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>    "[NavFn] Used %d cycles, %d cells visited (%d%%), priority buf max %d\n",</pre></td><td/></tr><tr><td class="line-number"><a name="L728" href="#L728"><pre>728</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>    cycle, nc, (int)((nc * 100.0) / (ns - nobs)), nwv);</pre></td><td/></tr><tr><td class="line-number"><a name="L729" href="#L729"><pre>729</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L730" href="#L730"><pre>730</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  if (potarr[startCell] &lt; POT_HIGH) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L730" href="#L730"><span>730:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">74.0k</span>, <span class="None">False</span>: <span class="covered-line">47.3k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L731" href="#L731"><pre>731</pre></a></td><td class="covered-line"><pre>74.0k</pre></td><td class="code"><pre>    return true;  // finished up here}</pre></td><td/></tr><tr><td class="line-number"><a name="L732" href="#L732"><pre>732</pre></a></td><td class="covered-line"><pre>74.0k</pre></td><td class="code"><pre>  } else {</pre></td><td/></tr><tr><td class="line-number"><a name="L733" href="#L733"><pre>733</pre></a></td><td class="covered-line"><pre>47.3k</pre></td><td class="code"><pre>    return false;</pre></td><td/></tr><tr><td class="line-number"><a name="L734" href="#L734"><pre>734</pre></a></td><td class="covered-line"><pre>47.3k</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L735" href="#L735"><pre>735</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>}</pre></td><td/></tr></table></div><div class="centered"><table><div class="source-name-title"><pre>nav2_navfn_planner::NavFn::calcPath(int, int*)</pre></div><tr><td><pre>Line</pre></td><td><pre>Count</pre></td><td><pre>Source (<a href="#L763">jump to first uncovered line</a>)</pre></td><td><pre>Explanation</pre></td></tr><tr><td class="line-number"><a name="L757" href="#L757"><pre>757</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>{</pre></td><td/></tr><tr><td class="line-number"><a name="L758" href="#L758"><pre>758</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // test write</pre></td><td/></tr><tr><td class="line-number"><a name="L759" href="#L759"><pre>759</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // savemap("test");</pre></td><td/></tr><tr><td class="line-number"><a name="L760" href="#L760"><pre>760</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L761" href="#L761"><pre>761</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // check path arrays</pre></td><td/></tr><tr><td class="line-number"><a name="L762" href="#L762"><pre>762</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  if (npathbuf &lt; n) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L762" href="#L762"><span>762:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">101</span>, <span class="None">False</span>: <span class="covered-line">121k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L763" href="#L763"><pre>763</pre></a></td><td class="covered-line"><pre>101</pre></td><td class="code"><pre>    if (pathx) <div class="tooltip"><span class="red">{delete[] pathx;}</span><span class="tooltip-content">0</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L763" href="#L763"><span>763:9</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">101</span>]
</pre></div></td><td class="explanation"><code>pathx</code> is always <code>nullptr</code> since we do not reuse the same <code>NavFn</code> object for calculating multiples paths</td></tr><tr><td class="line-number"><a name="L764" href="#L764"><pre>764</pre></a></td><td class="covered-line"><pre>101</pre></td><td class="code"><pre>    if (pathy) <div class="tooltip"><span class="red">{delete[] pathy;}</span><span class="tooltip-content">0</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L764" href="#L764"><span>764:9</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">101</span>]
</pre></div></td><td class="explanation">The same as above for <code>pathy</code></td></tr><tr><td class="line-number"><a name="L765" href="#L765"><pre>765</pre></a></td><td class="covered-line"><pre>101</pre></td><td class="code"><pre>    pathx = new float[n];</pre></td><td/></tr><tr><td class="line-number"><a name="L766" href="#L766"><pre>766</pre></a></td><td class="covered-line"><pre>101</pre></td><td class="code"><pre>    pathy = new float[n];</pre></td><td/></tr><tr><td class="line-number"><a name="L767" href="#L767"><pre>767</pre></a></td><td class="covered-line"><pre>101</pre></td><td class="code"><pre>    npathbuf = n;</pre></td><td/></tr><tr><td class="line-number"><a name="L768" href="#L768"><pre>768</pre></a></td><td class="covered-line"><pre>101</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L769" href="#L769"><pre>769</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L770" href="#L770"><pre>770</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // set up start position at cell</pre></td><td/></tr><tr><td class="line-number"><a name="L771" href="#L771"><pre>771</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // st is always upper left corner for 4-point bilinear interpolation</pre></td><td/></tr><tr><td class="line-number"><a name="L772" href="#L772"><pre>772</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  if (st == NULL) {st = start;}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L772" href="#L772"><span>772:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">121k</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td class="explanation">Again, since we do not reuse <code>NavFn</code> objects, <code>st</code> is always zero here</td></tr><tr><td class="line-number"><a name="L773" href="#L773"><pre>773</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  int stc = st[1] * nx + st[0];</pre></td><td/></tr><tr><td class="line-number"><a name="L774" href="#L774"><pre>774</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L775" href="#L775"><pre>775</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // set up offset</pre></td><td/></tr><tr><td class="line-number"><a name="L776" href="#L776"><pre>776</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  float dx = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L777" href="#L777"><pre>777</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  float dy = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L778" href="#L778"><pre>778</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>  npath = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L779" href="#L779"><pre>779</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L780" href="#L780"><pre>780</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // go for &lt;n&gt; cycles at most</pre></td><td/></tr><tr><td class="line-number"><a name="L781" href="#L781"><pre>781</pre></a></td><td class="covered-line"><pre>631k</pre></td><td class="code"><pre>  for (int i = 0; i &lt; n; <div class="tooltip">i++<span class="tooltip-content">510k</span></div>) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L781" href="#L781"><span>781:19</span></a></span>): [<span class="None">True</span>: <span class="covered-line">631k</span>, <span class="None">False</span>: <span class="covered-line">23</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L782" href="#L782"><pre>782</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // check if near goal</pre></td><td/></tr><tr><td class="line-number"><a name="L783" href="#L783"><pre>783</pre></a></td><td class="covered-line"><pre>631k</pre></td><td class="code"><pre>    int nearest_point = std::max(</pre></td><td/></tr><tr><td class="line-number"><a name="L784" href="#L784"><pre>784</pre></a></td><td class="covered-line"><pre>631k</pre></td><td class="code"><pre>      0,</pre></td><td/></tr><tr><td class="line-number"><a name="L785" href="#L785"><pre>785</pre></a></td><td class="covered-line"><pre>631k</pre></td><td class="code"><pre>      std::min(</pre></td><td/></tr><tr><td class="line-number"><a name="L786" href="#L786"><pre>786</pre></a></td><td class="covered-line"><pre>631k</pre></td><td class="code"><pre>        nx * ny - 1, stc + static_cast&lt;int&gt;(round(dx)) +</pre></td><td/></tr><tr><td class="line-number"><a name="L787" href="#L787"><pre>787</pre></a></td><td class="covered-line"><pre>631k</pre></td><td class="code"><pre>        static_cast&lt;int&gt;(nx * round(dy))));</pre></td><td/></tr><tr><td class="line-number"><a name="L788" href="#L788"><pre>788</pre></a></td><td class="covered-line"><pre>631k</pre></td><td class="code"><pre>    if (potarr[nearest_point] &lt; COST_NEUTRAL) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L788" href="#L788"><span>788:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">74.0k</span>, <span class="None">False</span>: <span class="covered-line">557k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L789" href="#L789"><pre>789</pre></a></td><td class="covered-line"><pre>74.0k</pre></td><td class="code"><pre>      pathx[npath] = static_cast&lt;float&gt;(goal[0]);</pre></td><td/></tr><tr><td class="line-number"><a name="L790" href="#L790"><pre>790</pre></a></td><td class="covered-line"><pre>74.0k</pre></td><td class="code"><pre>      pathy[npath] = static_cast&lt;float&gt;(goal[1]);</pre></td><td/></tr><tr><td class="line-number"><a name="L791" href="#L791"><pre>791</pre></a></td><td class="covered-line"><pre>74.0k</pre></td><td class="code"><pre>      return ++npath;  // done!</pre></td><td/></tr><tr><td class="line-number"><a name="L792" href="#L792"><pre>792</pre></a></td><td class="covered-line"><pre>74.0k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L793" href="#L793"><pre>793</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L794" href="#L794"><pre>794</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    if (stc &lt; nx || stc &gt; ns - nx) <span class="red">{  // would be out of bounds</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L794" href="#L794"><span>794:9</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">557k</span>]
  Branch (<span class="line-number"><a name="L794" href="#L794"><span>794:21</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">557k</span>]
</pre></div></td><td class="explanation">It is impossible that <code>calcPath</code>' <code>stc</code> get out of bounds, since the NavFn preprocessing automatically inserts a 1-pixel border of obstacles to the input map</td></tr><tr><td class="line-number"><a name="L795" href="#L795"><pre>795</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      </span><span class="red">RCLCPP_DEBUG</span><span class="red">(rclcpp::get_logger("rclcpp"), "[PathCalc] Out of bounds");</span></pre></td><td/></tr><tr><td class="line-number"><a name="L796" href="#L796"><pre>796</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      return 0;</span></pre></td><td/></tr><tr><td class="line-number"><a name="L797" href="#L797"><pre>797</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    }</span></pre></td><td/></tr><tr><td class="line-number"><a name="L798" href="#L798"><pre>798</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L799" href="#L799"><pre>799</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // add to path</pre></td><td/></tr><tr><td class="line-number"><a name="L800" href="#L800"><pre>800</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    pathx[npath] = stc % nx + dx;</pre></td><td/></tr><tr><td class="line-number"><a name="L801" href="#L801"><pre>801</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    pathy[npath] = stc / nx + dy;</pre></td><td/></tr><tr><td class="line-number"><a name="L802" href="#L802"><pre>802</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    npath++;</pre></td><td/></tr><tr><td class="line-number"><a name="L803" href="#L803"><pre>803</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L804" href="#L804"><pre>804</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    bool oscillation_detected = false;</pre></td><td/></tr><tr><td class="line-number"><a name="L805" href="#L805"><pre>805</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    if (npath &gt; 2 &amp;&amp;</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L805" href="#L805"><span>805:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">375k</span>, <span class="None">False</span>: <span class="covered-line">182k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L806" href="#L806"><pre>806</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">pathx[npath - 1] == pathx[npath - 3]<span class="tooltip-content">375k</span></div> &amp;&amp;</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L806" href="#L806"><span>806:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">83.9k</span>, <span class="None">False</span>: <span class="covered-line">291k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L807" href="#L807"><pre>807</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">pathy[npath - 1] == pathy[npath - 3]<span class="tooltip-content">83.9k</span></div>)</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L807" href="#L807"><span>807:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">152</span>, <span class="None">False</span>: <span class="covered-line">83.8k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L808" href="#L808"><pre>808</pre></a></td><td class="covered-line"><pre>152</pre></td><td class="code"><pre>    {</pre></td><td/></tr><tr><td class="line-number"><a name="L809" href="#L809"><pre>809</pre></a></td><td class="covered-line"><pre>152</pre></td><td class="code"><pre>      RCLCPP_DEBUG(</pre></td><td/></tr><tr><td class="line-number"><a name="L810" href="#L810"><pre>810</pre></a></td><td class="covered-line"><pre>152</pre></td><td class="code"><pre>        rclcpp::get_logger("rclcpp"),</pre></td><td/></tr><tr><td class="line-number"><a name="L811" href="#L811"><pre>811</pre></a></td><td class="covered-line"><pre>152</pre></td><td class="code"><pre>        "[PathCalc] oscillation detected, attempting fix.");</pre></td><td/></tr><tr><td class="line-number"><a name="L812" href="#L812"><pre>812</pre></a></td><td class="covered-line"><pre>152</pre></td><td class="code"><pre>      oscillation_detected = true;</pre></td><td/></tr><tr><td class="line-number"><a name="L813" href="#L813"><pre>813</pre></a></td><td class="covered-line"><pre>152</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L814" href="#L814"><pre>814</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L815" href="#L815"><pre>815</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    int stcnx = stc + nx;</pre></td><td/></tr><tr><td class="line-number"><a name="L816" href="#L816"><pre>816</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    int stcpx = stc - nx;</pre></td><td/></tr><tr><td class="line-number"><a name="L817" href="#L817"><pre>817</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L818" href="#L818"><pre>818</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // check for potentials at eight positions near cell</pre></td><td/></tr><tr><td class="line-number"><a name="L819" href="#L819"><pre>819</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>    if (potarr[stc] &gt;= POT_HIGH ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L819" href="#L819"><span>819:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">47.3k</span>, <span class="None">False</span>: <span class="covered-line">510k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L820" href="#L820"><pre>820</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stc + 1] &gt;= <span class="tooltip-content">510k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">510k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L820" href="#L820"><span>820:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">156k</span>, <span class="None">False</span>: <span class="covered-line">353k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L821" href="#L821"><pre>821</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stc - 1] &gt;= <span class="tooltip-content">353k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">353k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L821" href="#L821"><span>821:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">47.2k</span>, <span class="None">False</span>: <span class="covered-line">306k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L822" href="#L822"><pre>822</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stcnx] &gt;= <span class="tooltip-content">306k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">306k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L822" href="#L822"><span>822:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">108k</span>, <span class="None">False</span>: <span class="covered-line">197k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L823" href="#L823"><pre>823</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stcnx + 1] &gt;= <span class="tooltip-content">197k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">197k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L823" href="#L823"><span>823:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">12.0k</span>, <span class="None">False</span>: <span class="covered-line">185k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L824" href="#L824"><pre>824</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stcnx - 1] &gt;= <span class="tooltip-content">185k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">185k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L824" href="#L824"><span>824:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">5.35k</span>, <span class="None">False</span>: <span class="covered-line">180k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L825" href="#L825"><pre>825</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stcpx] &gt;= <span class="tooltip-content">180k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">180k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L825" href="#L825"><span>825:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">12.0k</span>, <span class="None">False</span>: <span class="covered-line">168k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L826" href="#L826"><pre>826</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stcpx + 1] &gt;= <span class="tooltip-content">168k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">168k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L826" href="#L826"><span>826:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">3.34k</span>, <span class="None">False</span>: <span class="covered-line">165k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L827" href="#L827"><pre>827</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">potarr[stcpx - 1] &gt;= <span class="tooltip-content">165k</span></div><div class="tooltip">POT_HIGH<span class="tooltip-content">165k</span></div> ||</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L827" href="#L827"><span>827:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.91k</span>, <span class="None">False</span>: <span class="covered-line">163k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L828" href="#L828"><pre>828</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>      <div class="tooltip">oscillation_detected<span class="tooltip-content">163k</span></div>)</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L828" href="#L828"><span>828:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">152</span>, <span class="None">False</span>: <span class="covered-line">162k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L829" href="#L829"><pre>829</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>    {</pre></td><td/></tr><tr><td class="line-number"><a name="L830" href="#L830"><pre>830</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      RCLCPP_DEBUG(</pre></td><td/></tr><tr><td class="line-number"><a name="L831" href="#L831"><pre>831</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>        rclcpp::get_logger("rclcpp"),</pre></td><td/></tr><tr><td class="line-number"><a name="L832" href="#L832"><pre>832</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>        "[Path] Pot fn boundary, following grid (%0.1f/%d)", potarr[stc], npath);</pre></td><td/></tr><tr><td class="line-number"><a name="L833" href="#L833"><pre>833</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L834" href="#L834"><pre>834</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // check eight neighbors to find the lowest</pre></td><td/></tr><tr><td class="line-number"><a name="L835" href="#L835"><pre>835</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      int minc = stc;</pre></td><td/></tr><tr><td class="line-number"><a name="L836" href="#L836"><pre>836</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      int minp = potarr[stc];</pre></td><td/></tr><tr><td class="line-number"><a name="L837" href="#L837"><pre>837</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      int st = stcpx - 1;</pre></td><td/></tr><tr><td class="line-number"><a name="L838" href="#L838"><pre>838</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">46.4k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L838" href="#L838"><span>838:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">46.4k</span>, <span class="None">False</span>: <span class="covered-line">348k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L839" href="#L839"><pre>839</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      st++;</pre></td><td/></tr><tr><td class="line-number"><a name="L840" href="#L840"><pre>840</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">82.6k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L840" href="#L840"><span>840:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">82.6k</span>, <span class="None">False</span>: <span class="covered-line">311k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L841" href="#L841"><pre>841</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      st++;</pre></td><td/></tr><tr><td class="line-number"><a name="L842" href="#L842"><pre>842</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">34.8k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L842" href="#L842"><span>842:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">34.8k</span>, <span class="None">False</span>: <span class="covered-line">359k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L843" href="#L843"><pre>843</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      st = stc - 1;</pre></td><td/></tr><tr><td class="line-number"><a name="L844" href="#L844"><pre>844</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">78.2k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L844" href="#L844"><span>844:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">78.2k</span>, <span class="None">False</span>: <span class="covered-line">316k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L845" href="#L845"><pre>845</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      st = stc + 1;</pre></td><td/></tr><tr><td class="line-number"><a name="L846" href="#L846"><pre>846</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">79.5k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L846" href="#L846"><span>846:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">79.5k</span>, <span class="None">False</span>: <span class="covered-line">315k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L847" href="#L847"><pre>847</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      st = stcnx - 1;</pre></td><td/></tr><tr><td class="line-number"><a name="L848" href="#L848"><pre>848</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">31.6k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L848" href="#L848"><span>848:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">31.6k</span>, <span class="None">False</span>: <span class="covered-line">362k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L849" href="#L849"><pre>849</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      st++;</pre></td><td/></tr><tr><td class="line-number"><a name="L850" href="#L850"><pre>850</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">74.7k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L850" href="#L850"><span>850:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">74.7k</span>, <span class="None">False</span>: <span class="covered-line">319k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L851" href="#L851"><pre>851</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      st++;</pre></td><td/></tr><tr><td class="line-number"><a name="L852" href="#L852"><pre>852</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[st] &lt; minp) <div class="tooltip">{minp = potarr[st]; minc = st;}<span class="tooltip-content">22.5k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L852" href="#L852"><span>852:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">22.5k</span>, <span class="None">False</span>: <span class="covered-line">372k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L853" href="#L853"><pre>853</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      stc = minc;</pre></td><td/></tr><tr><td class="line-number"><a name="L854" href="#L854"><pre>854</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      dx = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L855" href="#L855"><pre>855</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      dy = 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L856" href="#L856"><pre>856</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L857" href="#L857"><pre>857</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      RCLCPP_DEBUG(</pre></td><td/></tr><tr><td class="line-number"><a name="L858" href="#L858"><pre>858</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>        rclcpp::get_logger("rclcpp"), "[Path] Pot: %0.1f  pos: %0.1f,%0.1f",</pre></td><td/></tr><tr><td class="line-number"><a name="L859" href="#L859"><pre>859</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>        potarr[stc], pathx[npath - 1], pathy[npath - 1]);</pre></td><td/></tr><tr><td class="line-number"><a name="L860" href="#L860"><pre>860</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L861" href="#L861"><pre>861</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>      if (potarr[stc] &gt;= POT_HIGH) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L861" href="#L861"><span>861:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">47.3k</span>, <span class="None">False</span>: <span class="covered-line">347k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L862" href="#L862"><pre>862</pre></a></td><td class="covered-line"><pre>47.3k</pre></td><td class="code"><pre>        RCLCPP_DEBUG(rclcpp::get_logger("rclcpp"), "[PathCalc] No path found, high potential");</pre></td><td/></tr><tr><td class="line-number"><a name="L863" href="#L863"><pre>863</pre></a></td><td class="uncovered-line"/><td class="code"><pre>        // savemap("navfn_highpot");</pre></td><td/></tr><tr><td class="line-number"><a name="L864" href="#L864"><pre>864</pre></a></td><td class="covered-line"><pre>47.3k</pre></td><td class="code"><pre>        return 0;</pre></td><td/></tr><tr><td class="line-number"><a name="L865" href="#L865"><pre>865</pre></a></td><td class="covered-line"><pre>47.3k</pre></td><td class="code"><pre>      }</pre></td><td/></tr><tr><td class="line-number"><a name="L866" href="#L866"><pre>866</pre></a></td><td class="covered-line"><pre>394k</pre></td><td class="code"><pre>    } else {  // have a good gradient here</pre></td><td/></tr><tr><td class="line-number"><a name="L867" href="#L867"><pre>867</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // get grad at four positions near cell</pre></td><td/></tr><tr><td class="line-number"><a name="L868" href="#L868"><pre>868</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      gradCell(stc);</pre></td><td/></tr><tr><td class="line-number"><a name="L869" href="#L869"><pre>869</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      gradCell(stc + 1);</pre></td><td/></tr><tr><td class="line-number"><a name="L870" href="#L870"><pre>870</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      gradCell(stcnx);</pre></td><td/></tr><tr><td class="line-number"><a name="L871" href="#L871"><pre>871</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      gradCell(stcnx + 1);</pre></td><td/></tr><tr><td class="line-number"><a name="L872" href="#L872"><pre>872</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L873" href="#L873"><pre>873</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L874" href="#L874"><pre>874</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // get interpolated gradient</pre></td><td/></tr><tr><td class="line-number"><a name="L875" href="#L875"><pre>875</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      float x1 = (1.0 - dx) * gradx[stc] + dx * gradx[stc + 1];</pre></td><td/></tr><tr><td class="line-number"><a name="L876" href="#L876"><pre>876</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      float x2 = (1.0 - dx) * gradx[stcnx] + dx * gradx[stcnx + 1];</pre></td><td/></tr><tr><td class="line-number"><a name="L877" href="#L877"><pre>877</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      float x = (1.0 - dy) * x1 + dy * x2;  // interpolated x</pre></td><td/></tr><tr><td class="line-number"><a name="L878" href="#L878"><pre>878</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      float y1 = (1.0 - dx) * grady[stc] + dx * grady[stc + 1];</pre></td><td/></tr><tr><td class="line-number"><a name="L879" href="#L879"><pre>879</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      float y2 = (1.0 - dx) * grady[stcnx] + dx * grady[stcnx + 1];</pre></td><td/></tr><tr><td class="line-number"><a name="L880" href="#L880"><pre>880</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      float y = (1.0 - dy) * y1 + dy * y2;  // interpolated y</pre></td><td/></tr><tr><td class="line-number"><a name="L881" href="#L881"><pre>881</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L882" href="#L882"><pre>882</pre></a></td><td class="uncovered-line"/><td class="code"><pre>#if 0</pre></td><td/></tr><tr><td class="line-number"><a name="L883" href="#L883"><pre>883</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // show gradients</pre></td><td/></tr><tr><td class="line-number"><a name="L884" href="#L884"><pre>884</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      RCLCPP_DEBUG(</pre></td><td/></tr><tr><td class="line-number"><a name="L885" href="#L885"><pre>885</pre></a></td><td class="uncovered-line"/><td class="code"><pre>        rclcpp::get_logger("rclcpp"),</pre></td><td/></tr><tr><td class="line-number"><a name="L886" href="#L886"><pre>886</pre></a></td><td class="uncovered-line"/><td class="code"><pre>        "[Path] %0.2f,%0.2f  %0.2f,%0.2f  %0.2f,%0.2f  %0.2f,%0.2f; final x=%.3f, y=%.3f\n",</pre></td><td/></tr><tr><td class="line-number"><a name="L887" href="#L887"><pre>887</pre></a></td><td class="uncovered-line"/><td class="code"><pre>        gradx[stc], grady[stc], gradx[stc + 1], grady[stc + 1],</pre></td><td/></tr><tr><td class="line-number"><a name="L888" href="#L888"><pre>888</pre></a></td><td class="uncovered-line"/><td class="code"><pre>        gradx[stcnx], grady[stcnx], gradx[stcnx + 1], grady[stcnx + 1],</pre></td><td/></tr><tr><td class="line-number"><a name="L889" href="#L889"><pre>889</pre></a></td><td class="uncovered-line"/><td class="code"><pre>        x, y);</pre></td><td/></tr><tr><td class="line-number"><a name="L890" href="#L890"><pre>890</pre></a></td><td class="uncovered-line"/><td class="code"><pre>#endif</pre></td><td/></tr><tr><td class="line-number"><a name="L891" href="#L891"><pre>891</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L892" href="#L892"><pre>892</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // check for zero gradient, failed</pre></td><td/></tr><tr><td class="line-number"><a name="L893" href="#L893"><pre>893</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      if (x == 0.0 &amp;&amp; <div class="tooltip">y == 0.0<span class="tooltip-content">7.23k</span></div>) <span class="red">{</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L893" href="#L893"><span>893:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">7.23k</span>, <span class="None">False</span>: <span class="covered-line">155k</span>]
  Branch (<span class="line-number"><a name="L893" href="#L893"><span>893:23</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">7.23k</span>]
</pre></div></td><td class="explanation">If the gradient (both <code>x</code> and <code>y</code>) were null, the navigation function will be constant or have a saddle point around the current cell, but its monotonical construction would not produce that situation</td></tr><tr><td class="line-number"><a name="L894" href="#L894"><pre>894</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">        </span><span class="red">RCLCPP_DEBUG</span><span class="red">(rclcpp::get_logger("rclcpp"), "[PathCalc] Zero gradient");</span></pre></td><td/></tr><tr><td class="line-number"><a name="L895" href="#L895"><pre>895</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">        return 0;</span></pre></td><td/></tr><tr><td class="line-number"><a name="L896" href="#L896"><pre>896</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      }</span></pre></td><td/></tr><tr><td class="line-number"><a name="L897" href="#L897"><pre>897</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L898" href="#L898"><pre>898</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // move in the right direction</pre></td><td/></tr><tr><td class="line-number"><a name="L899" href="#L899"><pre>899</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      float ss = pathStep / hypot(x, y);</pre></td><td/></tr><tr><td class="line-number"><a name="L900" href="#L900"><pre>900</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      dx += x * ss;</pre></td><td/></tr><tr><td class="line-number"><a name="L901" href="#L901"><pre>901</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      dy += y * ss;</pre></td><td/></tr><tr><td class="line-number"><a name="L902" href="#L902"><pre>902</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L903" href="#L903"><pre>903</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // check for overflow</pre></td><td/></tr><tr><td class="line-number"><a name="L904" href="#L904"><pre>904</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      if (dx &gt; 1.0) <div class="tooltip">{stc++; dx -= 1.0;}<span class="tooltip-content">16.8k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L904" href="#L904"><span>904:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">16.8k</span>, <span class="None">False</span>: <span class="covered-line">146k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L905" href="#L905"><pre>905</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      if (dx &lt; -1.0) <div class="tooltip">{stc--; dx += 1.0;}<span class="tooltip-content">18.7k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L905" href="#L905"><span>905:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">18.7k</span>, <span class="None">False</span>: <span class="covered-line">144k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L906" href="#L906"><pre>906</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      if (dy &gt; 1.0) <div class="tooltip">{stc += nx; dy -= 1.0;}<span class="tooltip-content">15.9k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L906" href="#L906"><span>906:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">15.9k</span>, <span class="None">False</span>: <span class="covered-line">146k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L907" href="#L907"><pre>907</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>      if (dy &lt; -1.0) <div class="tooltip">{stc -= nx; dy += 1.0;}<span class="tooltip-content">18.5k</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L907" href="#L907"><span>907:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">18.5k</span>, <span class="None">False</span>: <span class="covered-line">144k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L908" href="#L908"><pre>908</pre></a></td><td class="covered-line"><pre>162k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L909" href="#L909"><pre>909</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L910" href="#L910"><pre>910</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    //      ROS_INFO("[Path] Pot: %0.1f  grad: %0.1f,%0.1f  pos: %0.1f,%0.1f\n",</pre></td><td/></tr><tr><td class="line-number"><a name="L911" href="#L911"><pre>911</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    //      potarr[stc], x, y, pathx[npath-1], pathy[npath-1]);</pre></td><td/></tr><tr><td class="line-number"><a name="L912" href="#L912"><pre>912</pre></a></td><td class="covered-line"><pre>557k</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L913" href="#L913"><pre>913</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L914" href="#L914"><pre>914</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  //  return npath;  // out of cycles, return failure</pre></td><td/></tr><tr><td class="line-number"><a name="L915" href="#L915"><pre>915</pre></a></td><td class="covered-line"><pre>23</pre></td><td class="code"><pre>  RCLCPP_DEBUG(rclcpp::get_logger("rclcpp"), "[PathCalc] No path found, path too long");</pre></td><td/></tr><tr><td class="line-number"><a name="L916" href="#L916"><pre>916</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // savemap("navfn_pathlong");</pre></td><td/></tr><tr><td class="line-number"><a name="L917" href="#L917"><pre>917</pre></a></td><td class="covered-line"><pre>23</pre></td><td class="code"><pre>  return 0;  // out of cycles, return failure</pre></td><td/></tr><tr><td class="line-number"><a name="L918" href="#L918"><pre>918</pre></a></td><td class="covered-line"><pre>121k</pre></td><td class="code"><pre>}</pre></td><td/></tr></table></div><div class="centered"><table><div class="source-name-title"><pre>nav2_navfn_planner::NavFn::gradCell(int)</pre></div><tr><td><pre>Line</pre></td><td><pre>Count</pre></td><td><pre>Source (<a href="#L934">jump to first uncovered line</a>)</pre></td><td><pre>Explanation</pre></td></tr><tr><td class="line-number"><a name="L929" href="#L929"><pre>929</pre></a></td><td class="covered-line"><pre>651k</pre></td><td class="code"><pre>{</pre></td><td/></tr><tr><td class="line-number"><a name="L930" href="#L930"><pre>930</pre></a></td><td class="covered-line"><pre>651k</pre></td><td class="code"><pre>  if (gradx[n] + grady[n] &gt; 0.0) {  // check this cell</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L930" href="#L930"><span>930:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">179k</span>, <span class="None">False</span>: <span class="covered-line">472k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L931" href="#L931"><pre>931</pre></a></td><td class="covered-line"><pre>179k</pre></td><td class="code"><pre>    return 1.0;</pre></td><td/></tr><tr><td class="line-number"><a name="L932" href="#L932"><pre>932</pre></a></td><td class="covered-line"><pre>179k</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L933" href="#L933"><pre>933</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L934" href="#L934"><pre>934</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  if (n &lt; nx || n &gt; ns - nx) <span class="red">{  // would be out of bounds</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L934" href="#L934"><span>934:7</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">472k</span>]
  Branch (<span class="line-number"><a name="L934" href="#L934"><span>934:17</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">472k</span>]
</pre></div></td><td class="explanation">The first and last rows of the map are filled with obstacles by ROS, so <code>gradCell</code> cannot have been invoked on them (see the condition in line <a href="#L861">861</a>)</td></tr><tr><td class="line-number"><a name="L935" href="#L935"><pre>935</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    return 0.0;</span></pre></td><td/></tr><tr><td class="line-number"><a name="L936" href="#L936"><pre>936</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">  }</span></pre></td><td/></tr><tr><td class="line-number"><a name="L937" href="#L937"><pre>937</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L938" href="#L938"><pre>938</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  float cv = potarr[n];</pre></td><td/></tr><tr><td class="line-number"><a name="L939" href="#L939"><pre>939</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  float dx = 0.0;</pre></td><td/></tr><tr><td class="line-number"><a name="L940" href="#L940"><pre>940</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  float dy = 0.0;</pre></td><td/></tr><tr><td class="line-number"><a name="L941" href="#L941"><pre>941</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L942" href="#L942"><pre>942</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // check for in an obstacle</pre></td><td/></tr><tr><td class="line-number"><a name="L943" href="#L943"><pre>943</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  if (cv &gt;= POT_HIGH) <span class="red">{</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L943" href="#L943"><span>943:7</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="None">False</span>: <span class="covered-line">472k</span>]
</pre></div></td><td class="explanation"><code>gradCell</code> is never called on obstacles (see the condition in line <a href="#L861">861</a>)</td></tr><tr><td class="line-number"><a name="L944" href="#L944"><pre>944</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    if (</span><span class="red">potarr[n - 1] &lt; </span><span class="red">POT_HIGH</span><span class="red">) </span><span class="red">{</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L944" href="#L944"><span>944:9</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td class="explanation">These lines until <a href="#L953">953</a> are inside a condition that is never met</td></tr><tr><td class="line-number"><a name="L945" href="#L945"><pre>945</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      dx = -</span><span class="red">COST_OBS</span><span class="red">;</span></pre></td><td/></tr><tr><td class="line-number"><a name="L946" href="#L946"><pre>946</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    } else </span><span class="red">if (</span><span class="red">potarr[n + 1] &lt; </span><span class="red">POT_HIGH</span><span class="red">) </span><span class="red">{</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L946" href="#L946"><span>946:16</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L947" href="#L947"><pre>947</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      dx = </span><span class="red">COST_OBS</span><span class="red">;</span></pre></td><td/></tr><tr><td class="line-number"><a name="L948" href="#L948"><pre>948</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    }</span></pre></td><td/></tr><tr><td class="line-number"><a name="L949" href="#L949"><pre>949</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    if (</span><span class="red">potarr[n - nx] &lt; </span><span class="red">POT_HIGH</span><span class="red">) </span><span class="red">{</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L949" href="#L949"><span>949:9</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L950" href="#L950"><pre>950</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      dy = -</span><span class="red">COST_OBS</span><span class="red">;</span></pre></td><td/></tr><tr><td class="line-number"><a name="L951" href="#L951"><pre>951</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    } else </span><span class="red">if (</span><span class="red">potarr[n + nx] &lt; </span><span class="red">POT_HIGH</span><span class="red">) </span><span class="red">{</span></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L951" href="#L951"><span>951:16</span></a></span>): [<span class="red">True</span>: <span class="uncovered-line">0</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L952" href="#L952"><pre>952</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">      dy = </span><span class="red">COST_OBS</span><span class="red">;</span></pre></td><td/></tr><tr><td class="line-number"><a name="L953" href="#L953"><pre>953</pre></a></td><td class="uncovered-line"><pre>0</pre></td><td class="code"><pre><span class="red">    }</span></pre></td><td/></tr><tr><td class="line-number"><a name="L954" href="#L954"><pre>954</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre><span class="red">  }</span> else {  // not in an obstacle</pre></td><td/></tr><tr><td class="line-number"><a name="L955" href="#L955"><pre>955</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // dx calc, average to sides</pre></td><td/></tr><tr><td class="line-number"><a name="L956" href="#L956"><pre>956</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>    if (potarr[n - 1] &lt; POT_HIGH) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L956" href="#L956"><span>956:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">472k</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td class="explanation">This comparison must always hold due to the unsatisfied condition in lines <a href="#L819">819</a>-<a href="#L827">827</a> (<code>n - 1</code> is the current cell <code>stc</code> in <code>calcPath</code> or one of its neighbors)</td></tr><tr><td class="line-number"><a name="L957" href="#L957"><pre>957</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>      dx += potarr[n - 1] - cv;</pre></td><td/></tr><tr><td class="line-number"><a name="L958" href="#L958"><pre>958</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L959" href="#L959"><pre>959</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>    if (potarr[n + 1] &lt; POT_HIGH) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L959" href="#L959"><span>959:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">413k</span>, <span class="None">False</span>: <span class="covered-line">58.3k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L960" href="#L960"><pre>960</pre></a></td><td class="covered-line"><pre>413k</pre></td><td class="code"><pre>      dx += cv - potarr[n + 1];</pre></td><td/></tr><tr><td class="line-number"><a name="L961" href="#L961"><pre>961</pre></a></td><td class="covered-line"><pre>413k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L962" href="#L962"><pre>962</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L963" href="#L963"><pre>963</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // dy calc, average to sides</pre></td><td/></tr><tr><td class="line-number"><a name="L964" href="#L964"><pre>964</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>    if (potarr[n - nx] &lt; POT_HIGH) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L964" href="#L964"><span>964:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">472k</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td class="explanation">This comparison must always hold due to the unsatisfied condition in lines <a href="#L819">819</a>-<a href="#L827">827</a> (<code>n - nx</code> is the current cell <code>stc</code> in <code>calcPath</code> or one of its neighbors)</td></tr><tr><td class="line-number"><a name="L965" href="#L965"><pre>965</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>      dy += potarr[n - nx] - cv;</pre></td><td/></tr><tr><td class="line-number"><a name="L966" href="#L966"><pre>966</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L967" href="#L967"><pre>967</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>    if (potarr[n + nx] &lt; POT_HIGH) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L967" href="#L967"><span>967:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">419k</span>, <span class="None">False</span>: <span class="covered-line">52.3k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L968" href="#L968"><pre>968</pre></a></td><td class="covered-line"><pre>419k</pre></td><td class="code"><pre>      dy += cv - potarr[n + nx];</pre></td><td/></tr><tr><td class="line-number"><a name="L969" href="#L969"><pre>969</pre></a></td><td class="covered-line"><pre>419k</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L970" href="#L970"><pre>970</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L971" href="#L971"><pre>971</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L972" href="#L972"><pre>972</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // normalize</pre></td><td/></tr><tr><td class="line-number"><a name="L973" href="#L973"><pre>973</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  float norm = hypot(dx, dy);</pre></td><td/></tr><tr><td class="line-number"><a name="L974" href="#L974"><pre>974</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  if (norm &gt; 0) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L974" href="#L974"><span>974:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">471k</span>, <span class="None">False</span>: <span class="covered-line">791</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L975" href="#L975"><pre>975</pre></a></td><td class="covered-line"><pre>471k</pre></td><td class="code"><pre>    norm = 1.0 / norm;</pre></td><td/></tr><tr><td class="line-number"><a name="L976" href="#L976"><pre>976</pre></a></td><td class="covered-line"><pre>471k</pre></td><td class="code"><pre>    gradx[n] = norm * dx;</pre></td><td/></tr><tr><td class="line-number"><a name="L977" href="#L977"><pre>977</pre></a></td><td class="covered-line"><pre>471k</pre></td><td class="code"><pre>    grady[n] = norm * dy;</pre></td><td/></tr><tr><td class="line-number"><a name="L978" href="#L978"><pre>978</pre></a></td><td class="covered-line"><pre>471k</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L979" href="#L979"><pre>979</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>  return norm;</pre></td><td/></tr><tr><td class="line-number"><a name="L980" href="#L980"><pre>980</pre></a></td><td class="covered-line"><pre>472k</pre></td><td class="code"><pre>}</pre></td><td/></tr></table></div><div class="centered"><table><div class="source-name-title"><pre>nav2_navfn_planner::NavFn::updateCellAstar(int)</pre></div><tr><td><pre>Line</pre></td><td><pre>Count</pre></td><td><pre>Source</pre></td><td><pre>Explanation</pre></td></tr><tr><td class="line-number"><a name="L497" href="#L497"><pre>497</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>{</pre></td><td/></tr><tr><td class="line-number"><a name="L498" href="#L498"><pre>498</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // get neighbors</pre></td><td/></tr><tr><td class="line-number"><a name="L499" href="#L499"><pre>499</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  float u, d, l, r;</pre></td><td/></tr><tr><td class="line-number"><a name="L500" href="#L500"><pre>500</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  l = potarr[n - 1];</pre></td><td/></tr><tr><td class="line-number"><a name="L501" href="#L501"><pre>501</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  r = potarr[n + 1];</pre></td><td/></tr><tr><td class="line-number"><a name="L502" href="#L502"><pre>502</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  u = potarr[n - nx];</pre></td><td/></tr><tr><td class="line-number"><a name="L503" href="#L503"><pre>503</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  d = potarr[n + nx];</pre></td><td/></tr><tr><td class="line-number"><a name="L504" href="#L504"><pre>504</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // ROS_INFO("[Update] c: %0.1f  l: %0.1f  r: %0.1f  u: %0.1f  d: %0.1f\n",</pre></td><td/></tr><tr><td class="line-number"><a name="L505" href="#L505"><pre>505</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // potarr[n], l, r, u, d);</pre></td><td/></tr><tr><td class="line-number"><a name="L506" href="#L506"><pre>506</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // ROS_INFO("[Update] cost of %d: %d\n", n, costarr[n]);</pre></td><td/></tr><tr><td class="line-number"><a name="L507" href="#L507"><pre>507</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L508" href="#L508"><pre>508</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // find lowest, and its lowest neighbor</pre></td><td/></tr><tr><td class="line-number"><a name="L509" href="#L509"><pre>509</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  float ta, tc;</pre></td><td/></tr><tr><td class="line-number"><a name="L510" href="#L510"><pre>510</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  if (l &lt; r) <div class="tooltip">{tc = l;}<span class="tooltip-content">1.85M</span></div> else <div class="tooltip">{tc = r;}<span class="tooltip-content">2.71M</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L510" href="#L510"><span>510:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.85M</span>, <span class="None">False</span>: <span class="covered-line">2.71M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L511" href="#L511"><pre>511</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  if (u &lt; d) <div class="tooltip">{ta = u;}<span class="tooltip-content">1.78M</span></div> else <div class="tooltip">{ta = d;}<span class="tooltip-content">2.78M</span></div></pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L511" href="#L511"><span>511:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.78M</span>, <span class="None">False</span>: <span class="covered-line">2.78M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L512" href="#L512"><pre>512</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L513" href="#L513"><pre>513</pre></a></td><td class="uncovered-line"/><td class="code"><pre>  // do planar wave update</pre></td><td/></tr><tr><td class="line-number"><a name="L514" href="#L514"><pre>514</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  if (costarr[n] &lt; COST_OBS) {  // don't propagate into obstacles</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L514" href="#L514"><span>514:7</span></a></span>): [<span class="None">True</span>: <span class="covered-line">4.56M</span>, <span class="red">False</span>: <span class="uncovered-line">0</span>]
</pre></div></td><td class="explanation"><code>updateCellAstar</code> is never called on obstacles, since no obstacle is ever inserted in the queues (see the definitions of <code>push_cur</code>, <code>push_next</code>, and <code>push_over</code>)</td></tr><tr><td class="line-number"><a name="L515" href="#L515"><pre>515</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    float hf = static_cast&lt;float&gt;(costarr[n]);  // traversability factor</pre></td><td/></tr><tr><td class="line-number"><a name="L516" href="#L516"><pre>516</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    float dc = tc - ta;  // relative cost between ta,tc</pre></td><td/></tr><tr><td class="line-number"><a name="L517" href="#L517"><pre>517</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    if (dc &lt; 0) {  // ta is lowest</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L517" href="#L517"><span>517:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">2.23M</span>, <span class="None">False</span>: <span class="covered-line">2.33M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L518" href="#L518"><pre>518</pre></a></td><td class="covered-line"><pre>2.23M</pre></td><td class="code"><pre>      dc = -dc;</pre></td><td/></tr><tr><td class="line-number"><a name="L519" href="#L519"><pre>519</pre></a></td><td class="covered-line"><pre>2.23M</pre></td><td class="code"><pre>      ta = tc;</pre></td><td/></tr><tr><td class="line-number"><a name="L520" href="#L520"><pre>520</pre></a></td><td class="covered-line"><pre>2.23M</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L521" href="#L521"><pre>521</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L522" href="#L522"><pre>522</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // calculate new potential</pre></td><td/></tr><tr><td class="line-number"><a name="L523" href="#L523"><pre>523</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    float pot;</pre></td><td/></tr><tr><td class="line-number"><a name="L524" href="#L524"><pre>524</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    if (dc &gt;= hf) {  // if too large, use ta-only update</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L524" href="#L524"><span>524:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">2.51M</span>, <span class="None">False</span>: <span class="covered-line">2.04M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L525" href="#L525"><pre>525</pre></a></td><td class="covered-line"><pre>2.51M</pre></td><td class="code"><pre>      pot = ta + hf;</pre></td><td/></tr><tr><td class="line-number"><a name="L526" href="#L526"><pre>526</pre></a></td><td class="covered-line"><pre>2.51M</pre></td><td class="code"><pre>    } else {  // two-neighbor interpolation update</pre></td><td/></tr><tr><td class="line-number"><a name="L527" href="#L527"><pre>527</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // use quadratic approximation</pre></td><td/></tr><tr><td class="line-number"><a name="L528" href="#L528"><pre>528</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // might speed this up through table lookup, but still have to</pre></td><td/></tr><tr><td class="line-number"><a name="L529" href="#L529"><pre>529</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      //   do the divide</pre></td><td/></tr><tr><td class="line-number"><a name="L530" href="#L530"><pre>530</pre></a></td><td class="covered-line"><pre>2.04M</pre></td><td class="code"><pre>      float d = dc / hf;</pre></td><td/></tr><tr><td class="line-number"><a name="L531" href="#L531"><pre>531</pre></a></td><td class="covered-line"><pre>2.04M</pre></td><td class="code"><pre>      float v = -0.2301 * d * d + 0.5307 * d + 0.7040;</pre></td><td/></tr><tr><td class="line-number"><a name="L532" href="#L532"><pre>532</pre></a></td><td class="covered-line"><pre>2.04M</pre></td><td class="code"><pre>      pot = ta + hf * v;</pre></td><td/></tr><tr><td class="line-number"><a name="L533" href="#L533"><pre>533</pre></a></td><td class="covered-line"><pre>2.04M</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L534" href="#L534"><pre>534</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L535" href="#L535"><pre>535</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // ROS_INFO("[Update] new pot: %d\n", costarr[n]);</pre></td><td/></tr><tr><td class="line-number"><a name="L536" href="#L536"><pre>536</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L537" href="#L537"><pre>537</pre></a></td><td class="uncovered-line"/><td class="code"><pre>    // now add affected neighbors to priority blocks</pre></td><td/></tr><tr><td class="line-number"><a name="L538" href="#L538"><pre>538</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>    if (pot &lt; potarr[n]) {</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L538" href="#L538"><span>538:9</span></a></span>): [<span class="None">True</span>: <span class="covered-line">4.18M</span>, <span class="None">False</span>: <span class="covered-line">379k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L539" href="#L539"><pre>539</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      float le = INVSQRT2 * static_cast&lt;float&gt;(costarr[n - 1]);</pre></td><td/></tr><tr><td class="line-number"><a name="L540" href="#L540"><pre>540</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      float re = INVSQRT2 * static_cast&lt;float&gt;(costarr[n + 1]);</pre></td><td/></tr><tr><td class="line-number"><a name="L541" href="#L541"><pre>541</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      float ue = INVSQRT2 * static_cast&lt;float&gt;(costarr[n - nx]);</pre></td><td/></tr><tr><td class="line-number"><a name="L542" href="#L542"><pre>542</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      float de = INVSQRT2 * static_cast&lt;float&gt;(costarr[n + nx]);</pre></td><td/></tr><tr><td class="line-number"><a name="L543" href="#L543"><pre>543</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L544" href="#L544"><pre>544</pre></a></td><td class="uncovered-line"/><td class="code"><pre>      // calculate distance</pre></td><td/></tr><tr><td class="line-number"><a name="L545" href="#L545"><pre>545</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      int x = n % nx;</pre></td><td/></tr><tr><td class="line-number"><a name="L546" href="#L546"><pre>546</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      int y = n / nx;</pre></td><td/></tr><tr><td class="line-number"><a name="L547" href="#L547"><pre>547</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      float dist = hypot(x - start[0], y - start[1]) * static_cast&lt;float&gt;(COST_NEUTRAL);</pre></td><td/></tr><tr><td class="line-number"><a name="L548" href="#L548"><pre>548</pre></a></td><td class="uncovered-line"/><td class="code"><pre/></td><td/></tr><tr><td class="line-number"><a name="L549" href="#L549"><pre>549</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      potarr[n] = pot;</pre></td><td/></tr><tr><td class="line-number"><a name="L550" href="#L550"><pre>550</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      pot += dist;</pre></td><td/></tr><tr><td class="line-number"><a name="L551" href="#L551"><pre>551</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>      if (pot &lt; curT) {  // low-cost buffer block</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L551" href="#L551"><span>551:11</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.89M</span>, <span class="None">False</span>: <span class="covered-line">2.28M</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L552" href="#L552"><pre>552</pre></a></td><td class="covered-line"><pre>1.89M</pre></td><td class="code"><pre>        if (l &gt; pot + le) <div class="tooltip">{<span class="tooltip-content">1.17M</span></div><div class="tooltip">push_next<span class="tooltip-content">1.17M</span></div>(n - 1);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L552" href="#L552"><span>552:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.17M</span>, <span class="None">False</span>: <span class="covered-line">723k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L553" href="#L553"><pre>553</pre></a></td><td class="covered-line"><pre>1.89M</pre></td><td class="code"><pre>        if (r &gt; pot + re) <div class="tooltip">{<span class="tooltip-content">1.21M</span></div><div class="tooltip">push_next<span class="tooltip-content">1.21M</span></div>(n + 1);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L553" href="#L553"><span>553:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.21M</span>, <span class="None">False</span>: <span class="covered-line">683k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L554" href="#L554"><pre>554</pre></a></td><td class="covered-line"><pre>1.89M</pre></td><td class="code"><pre>        if (u &gt; pot + ue) <div class="tooltip">{<span class="tooltip-content">1.15M</span></div><div class="tooltip">push_next<span class="tooltip-content">1.15M</span></div>(n - nx);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L554" href="#L554"><span>554:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.15M</span>, <span class="None">False</span>: <span class="covered-line">741k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L555" href="#L555"><pre>555</pre></a></td><td class="covered-line"><pre>1.89M</pre></td><td class="code"><pre>        if (d &gt; pot + de) <div class="tooltip">{<span class="tooltip-content">1.21M</span></div><div class="tooltip">push_next<span class="tooltip-content">1.21M</span></div>(n + nx);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L555" href="#L555"><span>555:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.21M</span>, <span class="None">False</span>: <span class="covered-line">682k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L556" href="#L556"><pre>556</pre></a></td><td class="covered-line"><pre>2.28M</pre></td><td class="code"><pre>      } else {</pre></td><td/></tr><tr><td class="line-number"><a name="L557" href="#L557"><pre>557</pre></a></td><td class="covered-line"><pre>2.28M</pre></td><td class="code"><pre>        if (l &gt; pot + le) <div class="tooltip">{<span class="tooltip-content">1.33M</span></div><div class="tooltip">push_over<span class="tooltip-content">1.33M</span></div>(n - 1);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L557" href="#L557"><span>557:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.33M</span>, <span class="None">False</span>: <span class="covered-line">950k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L558" href="#L558"><pre>558</pre></a></td><td class="covered-line"><pre>2.28M</pre></td><td class="code"><pre>        if (r &gt; pot + re) <div class="tooltip">{<span class="tooltip-content">1.38M</span></div><div class="tooltip">push_over<span class="tooltip-content">1.38M</span></div>(n + 1);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L558" href="#L558"><span>558:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.38M</span>, <span class="None">False</span>: <span class="covered-line">905k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L559" href="#L559"><pre>559</pre></a></td><td class="covered-line"><pre>2.28M</pre></td><td class="code"><pre>        if (u &gt; pot + ue) <div class="tooltip">{<span class="tooltip-content">1.39M</span></div><div class="tooltip">push_over<span class="tooltip-content">1.39M</span></div>(n - nx);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L559" href="#L559"><span>559:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.39M</span>, <span class="None">False</span>: <span class="covered-line">895k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L560" href="#L560"><pre>560</pre></a></td><td class="covered-line"><pre>2.28M</pre></td><td class="code"><pre>        if (d &gt; pot + de) <div class="tooltip">{<span class="tooltip-content">1.43M</span></div><div class="tooltip">push_over<span class="tooltip-content">1.43M</span></div>(n + nx);}</pre><div class="expansion-view"><pre>  Branch (<span class="line-number"><a name="L560" href="#L560"><span>560:13</span></a></span>): [<span class="None">True</span>: <span class="covered-line">1.43M</span>, <span class="None">False</span>: <span class="covered-line">853k</span>]
</pre></div></td><td/></tr><tr><td class="line-number"><a name="L561" href="#L561"><pre>561</pre></a></td><td class="covered-line"><pre>2.28M</pre></td><td class="code"><pre>      }</pre></td><td/></tr><tr><td class="line-number"><a name="L562" href="#L562"><pre>562</pre></a></td><td class="covered-line"><pre>4.18M</pre></td><td class="code"><pre>    }</pre></td><td/></tr><tr><td class="line-number"><a name="L563" href="#L563"><pre>563</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>  }</pre></td><td/></tr><tr><td class="line-number"><a name="L564" href="#L564"><pre>564</pre></a></td><td class="covered-line"><pre>4.56M</pre></td><td class="code"><pre>}</pre></td><td/></tr></table></div></body></html>